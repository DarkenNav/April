Тестовые задания по C# (WinForms)
(использовать платформу не выше .NET 4.5)

1. Реализовать новый класс таблицы с наименованием CustomDataGridView,
который наследуется от стандартного DataGridView. Установить по умолчанию режим
работы VirtualMode = true, все остальные задания будут рассчитаны на то, что
данный режиме включен.

2. Реализовать заполнение табличных данных CustomDataGridView через
DataSource, используя в качестве источника данных DataTable. Реализовать
синхронизацию изменения данных между таблицей и источником, если данные в
источнике (DataTable) были изменены, они должны сразу измениться в таблице
CustomDataGridView.

3. Реализовать фильтрацию табличных данных в CustomDataGridView при
условии, что в качестве источника данных выступает DataTable. Логика следующая:
пользователь нажимает на необходимую колонку в таблице (наименование колонки
становится «жирным»), затем если пользователь при активном фокусе таблицы
начинает печатать текст на клавиатуре, то выводится форма с TextBox, куда
набирается текст для фильтрации, и кнопками «ОК» и «Отмена». После нажатия кнопки
«ОК» текст в таблице должен отфильтроваться (через like %текст%) на основании
выделенной ранее колонки. Пример показан ниже.

4. Реализовать возможность индивидуального изменения колонок на
CustomDataGridView в разрезе пользователя, авторизованного в программе.
Пользователь должен изменять положение, ширину и видимость колонок таблицы с
дальнейшим сохранением этих изменений по конкретному авторизованному
пользователю в базе данных или в каком-нибудь файле в формате XML. Для
управления видимостью колонок и сохранения изменений можно использовать
контекстное меню на колонках таблицы. Соответственно при следующей загрузке
формы программы и инициализации CustomDataGridView, настройки должны
автоматически считаться из базы или файла по конкретному пользователю и
применить изменения на колонках. Идентификация конкретного CustomDataGridView
происходит по текстовому уникальному свойству GUID (необходимо добавить в класс
новое свойство).

5. Добавить новый класс колонки (к примеру,
CustomDataGridViewTextBoxColumn) для CustomDataGridView с новым свойством
CanSwitch (тип boolean). При нажатии определенной кнопки на форме должен
вызываться метод SwitchColumns(), который должен найти в таблице все колонки с 
типом CustomDataGridViewTextBoxColumn и установленным свойством CanSwitch =
true, и в зависимости от текущего состояния видимости колонки переключить его на
противоположное (если колонка видимая, то она должна скрыться и наоборот).

6. Реализовать интерфейс ICheckableControl, в который входят свойства
EmptyDataCheck (boolean) и EmptyDataText (string). Добавить также метод Check(),
который возвращает результат типа boolean. Суть интерфейса будет заключается в
том, чтобы использовать его на своих компонентах, которые могут наследоваться от
стандартных, для проверки заполнено ли поле ввода данных пользователем и если
нет, то выводить ему оповещение об этом.
EmptyDataCheck – проверять или нет компонент на то, что данные не пустые.
EmptyDataText – текст, который будет выводиться пользователю, если данные не
заполнены.
Check() – метод, который будет проверять на наличие данных в компоненте.
Создайте класс CustomTextBox, который будет наследоваться от стандартного TextBox
и ICheckableControl. Реализуйте в методе Check() в этом классе проверку на то, что
данные введены (не null и не пустая строка) при условии, что компонент необходимо
проверять. В случае, если данные пустые, то вывести MessageBox с текстом из
EmptyDataText.

7. Реализовать расширяющий метод bool DataCheck() для ControlCollection, в
котором будет производиться проверка всех элементов управления на форме с
интерфейсом ICheckableControl, который будет проверять через Check() введены ли
данные, в случае если в одном из элементов управления данные будут пустые, то
метод вернет false, в противном случае true.

8. Изменить в 6 задании вывод сообщения с MessageBox на Toolinfo (balloon).
Для этого необходимо реализовать класс BalloonTip и методом Show(string title, string
text, Control control, ToolTipIcon icon, double timeOut).
Описание аргументов:
 title – заголовок
 text – сообщение
 control – элемент управления, на котором будет выводиться оповещение
 icon – тип иконки оповещения
 timeOut – время отображения оповещения
Суть заключается в том, чтобы выводить оповещение на конкретном элементе
управления, само оповещение будет выводиться на основании позиции элемента
управления, ориентируясь на его середину координат. Необходимо использовать
Windows API и отправлять сформированное сообщение через SendMessage
(user32.dll). Пример показан ниже.

9. Реализовать в классе ScreenCapture метод Get() для снятия скриншота
рабочего стола компьютера пользователя.

10. Реализовать возможность глобального отлавливания всех ошибок приложения
(exception), в случае если в коде нету try/catch, чтобы ее обработать. Создать класс
ClientException, в котором реализовать метод Process() для обработки этих ошибок и
отправки оповещений на электронную почту. Письмо должно содержать следующую
информацию:
 код ошибки
 текст ошибки
 скриншот рабочего стола пользователя (задание 9)
 версия операционной системы
 имя пользователя в ОС
 последняя версия NET Framework, установленная на компьютере

11. Реализовать консольную программу для скачивания государственного реестра
лекарственных средств за текущую дату с сайта
http://www.grls.rosminzdrav.ru/LimPriceArchive.aspx (скачивать файл в формате zip).
После скачивания необходимо распаковать архив и считать содержимое Excel файла
в DataTable.
